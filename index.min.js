!function(){"use strict";function mapsPolyline(map,polylinesData,options){function getLineSymbol(color){return{path:"M 0,-1 0,1",fillColor:color,strokeColor:color,strokeOpacity:1,scale:3}}function loadMarkersAndLines(){var pinsList=getPins();pinsList.then(function(pins){return JSON.parse(pins)}).then(function(pins){return pins.data}).then(function(pins){return pins?(cleanUpLines(),cleanUpMarkers(),void pins.map(function(pin){var items=pin.items,color=pin.color;addLine(items,color),items.map(function(pin){addMarker(pin,color)})})):(console.error("No data specified"),!1)}).catch(function(error){console.error(error)})}function addLine(items,color){var coordinates=items.map(function(item){var lat=parseFloat(item.position.lat),lng=parseFloat(item.position.lng);return{lat:lat,lng:lng}}),polyline=new google.maps.Polyline({map:map,path:coordinates,strokeOpacity:0,icons:[{icon:getLineSymbol(color),offset:"0",repeat:"13px"}]});polylines.push(polyline)}function addMarker(pin,color){var position={lat:parseFloat(pin.position.lat),lng:parseFloat(pin.position.lng)},marker=new google.maps.Marker({map:map,id:pin.id,position:position,animation:google.maps.Animation.DROP,icon:{scale:1,fillOpacity:1,strokeWeight:0,fillColor:color,anchor:new google.maps.Point(0,0),path:"M-6,0a6,6 0 1,0 12,0a6,6 0 1,0 -12,0"}});marker.onclick=function(){options.callback&&"function"==typeof options.callback&&options.callback()}}function cleanUpMarkers(){markers.length>0&&markers.map(function(marker){marker.setMap(null)}),markers=[]}function cleanUpLines(){polylines.length>0&&polylines.map(function(polyline){polyline.setMap(null)})}function getPins(){return new Promise(function(resolve,reject){var jsonData=polylinesData;setTimeout(function(){resolve(jsonData)},1e3)})}var markers=[],polylines=[];loadMarkersAndLines()}HTMLElement.prototype.mapsPolyline=HTMLElement.prototype.mapsPolyline||function(mapObject,options){return mapsPolyline(mapObject,options)}}();